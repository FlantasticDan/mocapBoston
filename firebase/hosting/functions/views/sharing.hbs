<!DOCTYPE html>
<html>
    <header>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

        <!-- Open Graph / Social Meta -->
        <meta property="og:site_name" content="mocapBoston">
        <meta property="og:title" content="Motion Capture Performance">
        <meta property="og:description" content="Check out this 3D motion capture performance created at mocapBoston!">
        <meta property="og:url" content="https://mocap.boston/share/{{id}}">
        <meta property="fb:app_id" content="2275639242540793">
        <meta property="og:image" content="https://mocap.boston/branding/facebookBrand.jpg">
        <meta property="og:image:secure_url" content="https://mocap.boston/branding/facebookBrand.jpg">
        <meta property="og:image:type" content="image/jpeg">
        <meta property="og:image:width" content="1920">
        <meta property="og:image:height" content="1006">
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:image" content="https://mocap.boston/branding/twitterBrand.jpg">
        {{!-- Hey Snapchat, if you ever get your Creative Kit Implementation working I would love to know about it.
        Also maybe consider actually responding to developer bug reports instead of giving us the cold shoulder...
        <meta property="snapchat:sticker" content="https://mocap.boston/branding/snapStickSmall.webp"> --}}

        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">

        <title>mocapBoston Capture</title>

        <!-- Semantic UI Integration -->
        <link rel="stylesheet" type="text/css" href="/semantic/semantic.min.css">
        <script
            src="https://code.jquery.com/jquery-3.1.1.min.js"
            integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
            crossorigin="anonymous"></script>
        <script src="/semantic/semantic.min.js"></script>

    </header>
    <body>
        <div style="width: 100%; background-color: rgb(163, 163, 163);{{private}}">
            <div style="width:fit-content; width: -moz-fit-content; display: flex; vertical-align: middle; height: 28px; margin: 0 auto; text-align: center;">
                <img src="/icons/lock.svg" height="15px" width="auto" style="float:left; margin:auto 0;">
                <p style="margin-top: auto; margin-bottom: auto; margin-left: 5px;"><b>This capture is private.</b></p>
            </div>
        </div>
        <div style="background-color: #0D0A0B; padding-top: 25px; padding-bottom: 25px;">
            
            <div class="ui main container">
                <h1 class="ui center aligned inverted header">mocapBoston</h1>
            
                <!-- Gif Placeholder -->
                <div class="ui black inverted segment" style="max-width: 960px; margin: auto;">
                    <div style="overflow: hidden; padding-top: 56.25%; position: relative;">
                        <video autoplay loop style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;" muted preload="auto">
                            <source id= "playerSource" src="https://giant.gfycat.com/{{gifID}}.webm" type="video/webm">
                        </video>
                    </div>
                </div>

                <!-- Session ID Segment Sample -->
                <div class="ui segment" style="width: max-content; margin: auto; margin-top: 10px;">
                    <div class="ui mini statistic">
                        <div class="value">
                            {{id}}
                        </div>
                        <div class="label">
                            Session ID
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="ui container" style="padding-top: 25px;">
            <div class="ui stackable two column grid">
                <div class="column">
                    <div class="ui three column grid">
                        <div class="column" style="text-align: center;">
                            <div class="snapchat-creative-kit-share" data-size=large style="display: inline-block;" data-share-url="https://mocap.boston/share/{{id}}"></div>
                        </div>
                        <div class="column" style="text-align: center;">
                            <a href="https://twitter.com/intent/tweet?text=Take%20a%20look%20at%20this%20motion%20capture%20performance%21&url=https://mocap.boston/share/{{id}}" class="twitter-share-button" data-size="large" data-show-count="false">Tweet</a>
                        </div>
                        <div class="column" style="text-align: center;">
                            <div class="fb-share-button" data-href="https://mocap.boston/share/{{id}}" data-layout="button" data-size="large">
                                <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmocap.boston%2Fshare%2F{{id}}&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">
                                    Share
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="ui three column grid">
                        <div class="column" style="text-align: center;">
                            <button id="giphyButton" class="ui black button" style="width: 80px; height: 28px; padding: 0;">
                                <div style="width:fit-content; width: -moz-fit-content; display: flex; vertical-align: middle; height: 28px; margin: 0 auto; text-align: center;">
                                    <img src="/branding/gfycat-logo.png" height="20px" width="auto" style="float:left; margin:auto 0;">
                                    <p style="margin-top: auto; margin-bottom: auto; margin-left: 3px;">Share</p>
                                </div>
                            </button>
                        </div>
                        <div class="column" style="text-align: center;">
                            <a href="http://thumbs.gfycat.com/{{gifID}}-size_restricted.gif" download="mocapBoston.gif">
                            <button id="download" class="ui red button" style="width: 105px; height: 28px; padding: 0;">
                                <div style="width:fit-content; width: -moz-fit-content; display: flex; vertical-align: middle; height: 28px; margin: 0 auto; text-align: center;">
                                    <img src="/icons/download.png" height="13px" width="auto" style="float:left; margin:auto 0;">
                                    <p style="margin-top: auto; margin-bottom: auto; margin-left: 5px;">Download</p>
                                </div>
                            </button></a>
                        </div>
                        <div class="column" style="text-align: center;">
                            <button id="copy" class="ui green button" style="width: 105px; height: 28px; padding: 0;">
                                <div style="width:fit-content; width: -moz-fit-content; display: flex; vertical-align: middle; height: 28px; margin: 0 auto; text-align: center;">
                                    <img src="/icons/link.png" height="13px" width="auto" style="float:left; margin:auto 0;">
                                    <p id="copytxt" style="margin-top: auto; margin-bottom: auto; margin-left: 5px;">Copy Link</p>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="ui container" style="padding-top: 25px;">
            <!-- Welcome Prompt -->
            <div class="ui raised top attached header segment">
                <h3>What is mocapBoston?</h3>
            </div>
            <div class="ui raised red attached segment">
                mocapBoston is one part technical demo, one part performance installation celebrating motion capture and striving to make the established technology more accessible.
                The installation allows participants to create an animation of their performance by wearing computer-vision enabled stickers which are processed 
                in near-realtime by an algorithm developed for this project which has since been made avaialable open-source.
            </div>
        </div>

        

        <div style="background-color: #0D0A0B; padding-top: 25px; padding-bottom: 25px; margin-top: 25px;">
            <div class="ui container">
                <div class="ui stackable two column grid">
                    <div class="column" style="height: 70px; display: block;">
                        <img src="/branding/dan-19.png" style="margin: auto; max-width: 100%; max-height: 100%; display: block;">
                    </div>
                    <div class="column" style="height: 70px;">
                        <img src="/branding/Built_with_Firebase_Logo_Knockout.png" style="margin: auto; max-width: 100%; max-height: 100%; display: block;">
                    </div>
                </div>
            </div>
        </div>

        {{!-- Share Button On Click Interactions --}}
        <script>
            const giphy = document.getElementById("giphyButton");
            const copy = document.getElementById("copy");

            giphy.onclick = function() {
                window.location.href = "https://gfycat.com/{{gifID}}";
            };

            const copyToClipboard = str => {
                const el = document.createElement('textarea');
                el.value = "https://mocap.boston/share/{{id}}";
                el.setAttribute('readonly', '');
                el.style.position = 'absolute';
                el.style.left = '-9999px';
                document.body.appendChild(el);
                el.select();
                document.execCommand('copy');
                document.body.removeChild(el);
                };
            
            copy.onclick = function () {
                const el = document.createElement('textarea');
                el.value = "https://mocap.boston/share/{{id}}";
                el.setAttribute('readonly', '');
                el.style.position = 'absolute';
                el.style.left = '-9999px';
                document.body.appendChild(el);
                el.select();
                document.execCommand('copy');
                document.body.removeChild(el);
                document.getElementById("copytxt").textContent = "Link Copied";
                copy.className = "ui olive button";
                };


        </script>

        <!-- Snapchat Share Integration -->
        <script>
            // Load the SDK asynchronously
            (function (d, s, id) {
                var js, sjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = "https://sdk.snapkit.com/js/v1/create.js";
                sjs.parentNode.insertBefore(js, sjs);
            }(document, 'script', 'snapkit-creative-kit-sdk'));
        </script>

        <!-- Twitter Share Integration -->
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

        <!-- Facebook Share Integration -->
        <div id="fb-root"></div>
        <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&autoLogAppEvents=1&version=v5.0&appId=2275639242540793"></script>

        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="/__/firebase/7.3.0/firebase-app.js"></script>

        <!-- TODO: Add SDKs for Firebase products that you want to use
            https://firebase.google.com/docs/web/setup#available-libraries -->
        <script src="/__/firebase/7.3.0/firebase-analytics.js"></script>
        <script src="/__/firebase/7.4.0/firebase-firestore.js"></script>

        <!-- Initialize Firebase -->
        <script src="/__/firebase/init.js"></script>

        {{!-- Firebase Auto Update GIF on Processing Finish --}}
        <script>
            const hasProcessed = {{processed}};

            if (!hasProcessed) {
                const gifPlayer = document.getElementById("playerSource");
                var db = firebase.firestore();

                var unsubscribe = db.collection("dev").doc("{{id}}")
                    .onSnapshot(function (doc){
                        if (doc.get("processed")) {
                            location.reload();
                        }
                    });
            }
        </script>

    </body>

</html>